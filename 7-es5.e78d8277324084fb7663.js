!function(){function t(n,e){return(t=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(n,e)}function n(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var o,r=i(t);if(n){var a=i(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return e(this,o)}}function e(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{V8Rk:function(e,i,r){"use strict";r.r(i),r.d(i,"OrganisationsModule",function(){return A});var s,c=r("ofXK"),u=r("3Pt+"),l=r("tyNb"),h=r("mrSG"),f=r("fXoL"),g=r("AytR"),p=r("LRne"),d=r("vkgz"),b=r("JIr8"),m=r("tk/3"),v=r("SF6U"),y=((s=function(){function t(n,e){o(this,t),this.http=n,this.logger=e,this.organisationsUrl=window.__env.apiDataworkBench}return a(t,[{key:"getOrganisations",value:function(){var t=this;return this.http.get(this.organisationsUrl+"/iati-publishers/current").pipe(Object(d.a)(function(n){return t.log("fetched organisations")}),Object(b.a)(this.handleError("getOrganisations",[])))}},{key:"log",value:function(t){g.a.production||console.log(t)}},{key:"handleError",value:function(){var t=this,n=arguments.length>1?arguments[1]:void 0;return function(e){return t.logger.error(e),Object(p.a)(n)}}}]),t}()).\u0275fac=function(t){return new(t||s)(f.Xb(m.a),f.Xb(v.a))},s.\u0275prov=f.Hb({token:s,factory:s.\u0275fac}),s),w=r("b6Gx"),O=r("7o/Q"),P=r("D0XW"),x=function(){function t(n,e){o(this,t),this.dueTime=n,this.scheduler=e}return a(t,[{key:"call",value:function(t,n){return n.subscribe(new k(t,this.dueTime,this.scheduler))}}]),t}(),k=function(e){!function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&t(n,e)}(r,e);var i=n(r);function r(t,n,e){var a;return o(this,r),(a=i.call(this,t)).dueTime=n,a.scheduler=e,a.debouncedSubscription=null,a.lastValue=null,a.hasValue=!1,a}return a(r,[{key:"_next",value:function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(_,this.dueTime,this))}},{key:"_complete",value:function(){this.debouncedNext(),this.destination.complete()}},{key:"debouncedNext",value:function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}},{key:"clearDebounce",value:function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}]),r}(O.a);function _(t){t.debouncedNext()}var C,S,I=r("/uUt"),M=["searchInput"],j=((C=function(){function t(){o(this,t),this.search=new f.n,this.term=new u.d}return a(t,[{key:"ngOnInit",value:function(){var t=this;this.term.valueChanges.pipe(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.a;return function(e){return e.lift(new x(t,n))}}(300)).pipe(Object(I.a)()).subscribe(function(n){return t.searchOrganisations()})}},{key:"searchOrganisations",value:function(){this.search.emit(this.term.value)}}]),t}()).\u0275fac=function(t){return new(t||C)},C.\u0275cmp=f.Fb({type:C,selectors:[["app-organisations-search"]],viewQuery:function(t,n){var e;1&t&&f.Bc(M,1),2&t&&f.oc(e=f.bc())&&(n.searchInput=e.first)},outputs:{search:"search"},decls:6,vars:1,consts:[[1,"search-container"],[1,"organisation-search-form"],["type","text","placeholder","Organisation name","appAutofocus","",1,"search-input",3,"formControl"],["searchInput",""],[1,"btn","btn-primary","iati-button",3,"click"]],template:function(t,n){1&t&&(f.Qb(0,"div",0),f.Qb(1,"div",1),f.Mb(2,"input",2,3),f.Qb(4,"button",4),f.ac("click",function(){return n.searchOrganisations()}),f.wc(5,"Search"),f.Pb(),f.Pb(),f.Pb()),2&t&&(f.yb(2),f.ic("formControl",n.term))},directives:[u.b,u.j,u.e],styles:[".organisation-search-form[_ngcontent-%COMP%]{width:500px;display:flex;flex-flow:row wrap;justify-content:space-around}@media (max-width:600px){.organisation-search-form[_ngcontent-%COMP%]{width:auto}}.organisation-search-form[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:350px;font-size:1.6rem;line-height:1.25;color:#464a4c;padding:.9rem 1.4rem;border:1px solid rgba(0,0,0,.14902);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (max-width:600px){.organisation-search-form[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%}}.organisation-search-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:150px;border-radius:0!important;text-align:center}@media (max-width:600px){.organisation-search-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin-top:20px;margin-bottom:10px;padding-top:15px;padding-bottom:15px}}"]}),C),Q=function(t){return["/organisation/",t]},R=((S=function(){function t(){o(this,t)}return a(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||S)},S.\u0275cmp=f.Fb({type:S,selectors:[["app-organisations-list-item"]],inputs:{organisation:"organisation"},decls:4,vars:4,consts:[[1,"row","organisation"],[1,"col"],[3,"routerLink"]],template:function(t,n){1&t&&(f.Qb(0,"div",0),f.Qb(1,"div",1),f.Qb(2,"a",2),f.wc(3),f.Pb(),f.Pb(),f.Pb()),2&t&&(f.yb(2),f.ic("routerLink",f.lc(2,Q,n.organisation.slug)),f.yb(1),f.yc(" ",n.organisation.name," "))},directives:[l.f],styles:[".organisation[_ngcontent-%COMP%]{font-size:1.5em}"]}),S);function T(t,n){1&t&&f.Mb(0,"app-organisations-list-item",2),2&t&&f.ic("organisation",n.$implicit)}var L,F=((L=function(){function t(){o(this,t),this.organisations=[]}return a(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||L)},L.\u0275cmp=f.Fb({type:L,selectors:[["app-organisations-list"]],inputs:{organisations:"organisations"},decls:4,vars:2,consts:[[1,"found-organization"],[3,"organisation",4,"ngFor","ngForOf"],[3,"organisation"]],template:function(t,n){1&t&&(f.Qb(0,"div",0),f.wc(1),f.Pb(),f.Mb(2,"hr"),f.uc(3,T,1,1,"app-organisations-list-item",1)),2&t&&(f.yb(1),f.yc("Found ",n.organisations.length," organisations."),f.yb(2),f.ic("ngForOf",n.organisations))},directives:[c.k,R],styles:[".found-organization[_ngcontent-%COMP%]{font-size:1.5em}"]}),L);function V(t,n){1&t&&(f.Qb(0,"div",4),f.wc(1,"Searching ...."),f.Pb())}var D,E,z=[{path:"",component:(D=function(){function t(n,e,i){o(this,t),this.organisationService=n,this.logger=e,this.loader=i,this.organisations=[],this.filteredOrganisations=[],this.isSearching=!1}return a(t,[{key:"ngOnInit",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.searchOrganisation("");case 1:case"end":return t.stop()}},t,this)}))}},{key:"searchOrganisation",value:function(t){var n=this;this.logger.debug("Start searching organisations",t),this.isSearching=!0,this.loader.show(),this.organisations&&0!==this.organisations.length?this.filterOrganisations(t):this.organisationService.getOrganisations().subscribe(function(t){return n.organisations=t},function(t){console.log(t),n.isSearching=!1,n.loader.hide()},function(){n.filterOrganisations(t)}),this.logger.debug("End searching organisations",t)}},{key:"filterOrganisations",value:function(t){this.filteredOrganisations=t&&t.trim()?this.organisations.filter(function(n){return new RegExp(t,"gi").test(n.name)}).sort(function(t,n){return(t.name||"").toString().toLowerCase().localeCompare((n.name||"").toString().toLowerCase())}):this.organisations.slice(0).sort(function(t,n){return(t.name||"").toString().toLowerCase().localeCompare((n.name||"").toString().toLowerCase())}),this.isSearching=!1,this.loader.hide()}}]),t}(),D.\u0275fac=function(t){return new(t||D)(f.Lb(y),f.Lb(v.a),f.Lb(w.a))},D.\u0275cmp=f.Fb({type:D,selectors:[["app-organisations"]],decls:8,vars:2,consts:[[1,"container"],[3,"search"],["class","text-info",4,"ngIf"],[3,"organisations"],[1,"text-info"]],template:function(t,n){1&t&&(f.Qb(0,"div",0),f.Qb(1,"h1"),f.wc(2,"Public data viewer"),f.Pb(),f.Qb(3,"p"),f.wc(4,"Search for an organisation and access the validation results on their public IATI data. The organisation list and the public IATI data is regularly refreshed from the IATI Registry. New organisations and IATI files will not immediately be visible here, but after at most a day. "),f.Pb(),f.Qb(5,"app-organisations-search",1),f.ac("search",function(t){return n.searchOrganisation(t)}),f.Pb(),f.uc(6,V,2,0,"div",2),f.Mb(7,"app-organisations-list",3),f.Pb()),2&t&&(f.yb(6),f.ic("ngIf",n.isSearching),f.yb(1),f.ic("organisations",n.filteredOrganisations))},directives:[j,c.l,F],styles:[""]}),D)},{path:"",redirectTo:"/404dqf",pathMatch:"full"}],A=((E=function t(){o(this,t)}).\u0275mod=f.Jb({type:E}),E.\u0275inj=f.Ib({factory:function(t){return new(t||E)},providers:[y],imports:[[c.b,l.g.forChild(z),u.g,u.n,l.g],l.g]}),E)}}])}();